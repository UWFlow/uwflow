- args:
    cascade: false
    sql: |-
      CREATE VIEW aggregate.prof_review_stats AS
      SELECT
          prof_id,
          SUM(CASE WHEN clear THEN 1 ELSE 0 END) AS clear,
          SUM(CASE WHEN NOT clear THEN 1 ELSE 0 END) AS not_clear,
          SUM(CASE WHEN engaging THEN 1 ELSE 0 END) AS engaging,
          SUM(CASE WHEN NOT engaging THEN 1 ELSE 0 END) AS not_engaging
      FROM prof_review GROUP BY prof_id;
  type: run_sql
- args:
    name: prof_review_stats
    schema: aggregate
  type: add_existing_table_or_view
